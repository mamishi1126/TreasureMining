# TreasureMining 
## プロジェクト概要 
TreasureMiningは、Minecraftのプレイヤーが鉱石を採掘して得点を競うミニゲームプラグインです。  
本プロジェクトは私がJava学習を通じて得た知識を活用し、ゲーム開発に挑戦する目的で制作しました。  

## 機能要件
### １．ゲームの進行
**・ゲーム開始**：`/treasuremining`コマンドで開始。画面上に「Let's mine the treasure! 制限時間1分」と表示。  
**・初期設定**：体力とフードレベルが最大になり、インベントリは空になります。メインハンドにダイアモンドのツルハシをセットします。  
**・ゲーム終了**：1分経過でゲームが終了し、画面上に獲得スコアが表示されます。インベントリが空になります。  

### ２．プレイヤーの鉱石採掘
**・鉱石の種類による得点**：各鉱石ごとに獲得ポイントが異なり、連続採掘でボーナスポイントが加算されます。  
&emsp;- 石炭：0点、ラピスラズリ：20点、ダイヤモンド：30点、エメラルド：60点  
**・連続発掘ボーナス**：同じ鉱石を連続で発掘すると、1回ごとに+10点のボーナス。  
**・ポイント制限**：ゲーム終了後はブロックを破壊してもポイントが追加されません。  

### ３．インベントリの管理 
**・ゲーム開始時**：インベントリは空になります。  
**・ゲーム中**：採掘した鉱石はインベントリに追加されます。  
**・ゲーム終了時**：インベントリは空になり、取得した鉱石は削除されます。  

### ４．データベース管理
**・ゲーム終了時の保存**：プレイヤー名、獲得ポイント、登録日時をデータベースに保存し記録として管理します。  
**・データの呼び出し**：`/treasuremining playerlist` と入力することで、保存されたデータ一覧を確認できます。  

## 工夫したポイント
**・オブジェクト指向設計**：`ExecutingPlayer`クラスを使用し、プレイヤーごとのスコアや連続採掘ボーナス情報を管理。多機能との連携や保守性を考慮しました。  
**・イベント駆動型の設計**：`BlockBreakEvent`を活用し、プレイヤーの鉱石採掘アクションに応じてリアルタイムでスコアを加算。イベントリスナによる柔軟なデータ処理を実現しました。  
**・効率的なスコアリングロジック**：鉱石ごとに異なる得点と連続採掘ボーナスを加算するスコアリングロジックを実装。条件分岐をシンプルに保ちながら柔軟なスコア管理を実現しました。  
**・ゲーム終了時のデータリセット**：終了時にプレイヤーのインベントリやスコアをリセットし、リソース消費を最適化。バックエンドにおける効率的なデータ処理とクリーンアップを行っています。  
**・データベース設計と管理**：プレイヤー情報やスコアをMyBatisでデータベースに記録。ゲーム終了時も記録が保持されるよう、スコア保存とデータ取得のパフォーマンスに配慮した実装を行いました。

## データベース設計
本プロジェクトではプレイヤーのスコアを管理するために、`player_score`テーブルを使用。

### テーブル: player_score
| カラム名         | データ型         | 説明                   |
|------------------|--------------|------------------------|
| `id`            | int          | プレイヤーID           |
| `player_name`   | varchar(100) | プレイヤーの名前       |
| `score`         | int          | 現在のスコア           |
| `registered_at` | dateTime     | データの登録日時       |

### データ例
| id  | player_name | score | registered_at       |
|-----|-------------|-------|---------------------|
| 1   | playerA     | 120   | 2023-10-25 12:34:56|

### 対応バージョン
・Minecraft：1.20.4  
・Spigot:1.20.4  

### デモ  
https://github.com/user-attachments/assets/65253c7c-d547-44dc-98e5-64f6a5620b7c